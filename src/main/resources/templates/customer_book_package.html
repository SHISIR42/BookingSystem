<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Book Package</title>
<link th:replace="~{fragments/navbar :: head}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" th:href="@{/css/customer_book_package.css}">
</head>
<body>
<div th:replace="~{fragments/navbar :: navigation('book-package')}"></div>

<div class="hero">
    <h1>Book Your Tickets</h1>
    <p>Complete your booking in just a few steps</p>
</div>

<div class="container">
    <div class="booking-form">
        <form th:action="@{/customer/book-package}" method="post" th:object="${booking}">
            <div class="form-group">
                <label><i class="fas fa-gift"></i> Select Package</label>
                <select id="packageSelect" onchange="updatePackageDetails()" required>
                    <option value="">Choose a package</option>
                    <option th:each="pkg : ${packages}" 
                            th:value="${pkg.pid}" 
                            th:text="${pkg.pname} + ' - $' + ${pkg.ppriced}"
                            th:attr="data-name=${pkg.pname}, data-price=${pkg.ppriced}">
                    </option>
                </select>
                <input type="hidden" th:field="*{packageId}" id="packageId">
                <input type="hidden" th:field="*{packageName}" id="packageName">
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-calendar"></i> Visit Date</label>
                <input type="date" th:field="*{bookingDate}" id="bookingDate"
                       th:value="${#temporals.format(#temporals.createToday(), 'yyyy-MM-dd')}" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-user"></i> Your Name</label>
                <input type="text" th:field="*{customerName}" 
                       th:value="${user?.fname != null ? user.fname + ' ' + user.lname : ''}" 
                       placeholder="Enter your full name" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-phone"></i> Phone Number</label>
                <input type="tel" th:field="*{customerPhone}" placeholder="Enter your phone number" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" th:field="*{customerEmail}" 
                       th:value="${user?.email}" 
                       placeholder="Enter your email" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-dollar-sign"></i> Total Amount</label>
                <input type="number" step="0.01" th:field="*{totalAmount}" id="totalAmount" readonly required>
                <div class="price-display" id="priceInfo" style="display:none;">
                    <strong>Total: $<span id="displayPrice">0.00</span></strong>
                </div>
            </div>
            
            <h3 style="color: #2821a9; margin: 2rem 0 1rem 0;"><i class="fas fa-credit-card"></i> Payment Method</h3>
            <div class="payment-options">
                <div class="payment-option" id="qrOption">
                    <i class="fas fa-qrcode"></i>
                    <p>QR Payment</p>
                </div>
                <div class="payment-option" id="cardOption">
                    <i class="far fa-credit-card"></i>
                    <p>Card Payment</p>
                </div>
            </div>
            <input type="hidden" th:field="*{paymentMethod}" id="paymentMethod" required>
            <input type="hidden" th:field="*{transactionId}" id="transactionId">
            <input type="hidden" th:field="*{paymentStatus}" id="paymentStatus" value="Pending">
            
            <div class="qr-code" id="qrCode">
                <p style="font-weight: 600; color: #2821a9;">Scan this QR code to pay</p>
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=TravelBooking-USD-0" 
                     alt="QR Code for Payment" id="qrImage">
                <p style="margin-top: 1rem; color: #666;">After payment, you will receive confirmation via SMS/Email</p>
            </div>
            
            <div class="card-payment" id="cardPayment">
                <div class="form-group">
                    <label>Card Number</label>
                    <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                    <div class="card-icons">
                        <i class="fab fa-cc-visa"></i>
                        <i class="fab fa-cc-mastercard"></i>
                        <i class="fab fa-cc-amex"></i>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <div class="form-group" style="flex: 1;">
                        <label>Expiry Date</label>
                        <input type="text" id="expiry" placeholder="MM/YY" maxlength="5">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label>CVV</label>
                        <input type="text" id="cvv" placeholder="123" maxlength="3">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Name on Card</label>
                    <input type="text" id="cardName" placeholder="Enter cardholder name">
                </div>
            </div>
            
            <button type="submit" class="btn-submit" id="submitBtn">
                <i class="fas fa-check-circle"></i> Complete Booking
            </button>
        </form>
    </div>
</div>

<script th:src="@{/js/customer_book_package.js}"></script>
</body>
</html>
