<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Book Package</title>
<link th:replace="~{fragments/navbar :: head}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" th:href="@{/css/customer_book_package.css}">
</head>
<body>
<div th:replace="~{fragments/navbar :: navigation('book-package')}"></div>

<div class="hero">
    <h1>Book Your Package</h1>
    <p>Complete your booking in just a few steps</p>
</div>

<div class="container">
    <div class="booking-form">
        <form th:action="@{/customer/book-package}" method="post" th:object="${booking}">
            <div class="form-group">
                <label><i class="fas fa-gift"></i> Select Package</label>
                <select id="packageSelect" onchange="updatePackageDetails()" required>
                    <option value="">Choose a package</option>
                    <option th:each="pkg : ${packages}" 
                            th:value="${pkg.pid}" 
                            th:text="${pkg.pname} + ' - $' + ${pkg.ppriced}"
                            th:attr="data-name=${pkg.pname}, data-price=${pkg.ppriced}">
                    </option>
                </select>
                <input type="hidden" th:field="*{packageId}" id="packageId">
                <input type="hidden" th:field="*{packageName}" id="packageName">
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-calendar"></i> Visit Date</label>
                <div class="date-picker-wrapper">
                    <input type="date" th:field="*{bookingDate}" id="bookingDate" class="simple-date-picker" required>
                    <small class="date-helper">Select your preferred visit date</small>
                </div>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-user"></i> Your Name</label>
                <input type="text" th:field="*{customerName}" 
                       th:value="${user?.fname != null ? user.fname + ' ' + user.lname : ''}" 
                       placeholder="Enter your full name" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-phone"></i> Phone Number</label>
                <input type="tel" th:field="*{customerPhone}" placeholder="Enter your phone number" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" th:field="*{customerEmail}" 
                       th:value="${user?.email}" 
                       placeholder="Enter your email" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-dollar-sign"></i> Total Amount</label>
                <input type="number" step="0.01" th:field="*{totalAmount}" id="totalAmount" readonly required>
                <div class="price-display" id="priceInfo" style="display:none;">
                    <strong>Total: $<span id="displayPrice">0.00</span></strong>
                </div>
            </div>
            
            <h3 style="color: #2821a9; margin: 2rem 0 1rem 0;"><i class="fas fa-credit-card"></i> Payment Method (Mock Payment - Demo Only)</h3>
            <div class="mock-payment-notice">
                <i class="fas fa-info-circle"></i>
                <p><strong>Demo Mode:</strong> This is a simulated payment system for demonstration purposes. No real payment will be processed.</p>
            </div>
            
            <div class="payment-options">
                <div class="payment-option" id="qrOption">
                    <i class="fas fa-qrcode"></i>
                    <p>Mock QR Payment</p>
                </div>
                <div class="payment-option" id="cardOption">
                    <i class="far fa-credit-card"></i>
                    <p>Mock Card Payment</p>
                </div>
            </div>
            <input type="hidden" th:field="*{paymentMethod}" id="paymentMethod" required>
            <input type="hidden" th:field="*{transactionId}" id="transactionId">
            <input type="hidden" th:field="*{paymentStatus}" id="paymentStatus" value="Completed">
            
            <div class="qr-code" id="qrCode">
                <p style="font-weight: 600; color: #2821a9;">Demo QR Code Payment</p>
                <div class="mock-qr-container">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=DEMO-PAYMENT" 
                         alt="Demo QR Code" id="qrImage">
                    <div class="mock-overlay">DEMO</div>
                </div>
                <p style="margin-top: 1rem; color: #666;">
                    <i class="fas fa-check-circle" style="color: #159557;"></i> 
                    Payment simulation successful! Click "Complete Booking" to proceed.
                </p>
            </div>
            
            <div class="card-payment" id="cardPayment">
                <div class="test-card-info">
                    <p><strong>Test Card Numbers:</strong></p>
                    <ul>
                        <li><i class="fab fa-cc-visa"></i> 4111 1111 1111 1111 (Visa)</li>
                        <li><i class="fab fa-cc-mastercard"></i> 5555 5555 5555 4444 (MasterCard)</li>
                        <li><i class="fab fa-cc-amex"></i> 3782 822463 10005 (Amex)</li>
                    </ul>
                    <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">Use any future date for expiry and any 3-digit CVV</p>
                </div>
                
                <div class="form-group">
                    <label>Card Number</label>
                    <input type="text" id="cardNumber" placeholder="4111 1111 1111 1111" maxlength="19" value="4111 1111 1111 1111">
                    <div class="card-icons">
                        <i class="fab fa-cc-visa"></i>
                        <i class="fab fa-cc-mastercard"></i>
                        <i class="fab fa-cc-amex"></i>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <div class="form-group" style="flex: 1;">
                        <label>Expiry Date</label>
                        <input type="text" id="expiry" placeholder="12/25" maxlength="5" value="12/25">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label>CVV</label>
                        <input type="text" id="cvv" placeholder="123" maxlength="3" value="123">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Name on Card</label>
                    <input type="text" id="cardName" placeholder="Test User" value="Test User">
                </div>
            </div>
            
            <button type="submit" class="btn-submit" id="submitBtn">
                <i class="fas fa-check-circle"></i> Complete Booking
            </button>
        </form>
    </div>
</div>

<script th:src="@{/js/customer_book_package.js}"></script>
</body>
</html>
